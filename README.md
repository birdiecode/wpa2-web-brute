# wpa2 web brute

## Тестовые данные 

Для тестирования работы алгоритма перебора паролей в проекте используется файл `data/capture-01.cap`, который содержит захваченный хендшейк точки доступа `Test_WiFi` с паролем `QWERTY12`. Этот файл можно использовать для анализа и демонстрации работы скрипта на реальном примере.

## Как захватить хендшейк

Для захвата хендшейка точки доступа можно использовать два метода.

### 1. С использованием `airmon-ng` и `airodump-ng`:
1. Перевести интерфейс в режим монитора:
   ```bash
   sudo airmon-ng start wlp59s0
   ```
2. Просмотреть доступные сети:
   ```bash
   sudo airodump-ng wlp59s0mon
   ```
3. Захватить хендшейк конкретной сети:
   ```bash
   sudo airodump-ng -c 11 --bssid 66:4B:93:37:28:0F -w capture wlp59s0mon
   ```

### 2. Используя `iwconfig` и `Wireshark`:
1. Перевести интерфейс в режим монитора:
   ```bash
   ifconfig wlan0 down
   iwconfig wlan0 mode monitor
   ifconfig wlan0 up
   ```
2. Открыть `Wireshark` и начать прослушивание интерфейса. Чтобы облегчить поиск, можно настроить фильтр на отображение только сообщений протокола EAPOL:
   ```
   _ws.col.protocol == "EAPOL"
   ```
## Данные, необходимые для подбора пароля

Для успешного подбора пароля необходимо извлечь из хендшейка следующие параметры:
- SSID — имя Wi-Fi сети (идентификатор точки доступа).
- BSSID — MAC-адрес точки доступа.
- STA — MAC-адрес клиента, подключающегося к сети.
- aNonce — случайное значение, сгенерированное точкой доступа.
- sNonce — случайное значение, сгенерированное клиентом.
- MIC — Message Integrity Code, который используется для проверки подлинности соединения.
- WPA Data — EAPOL-фрейм, содержащий данные второго сообщения 4-way хендшейка, но без ключа целостности (MIC).

parse_cap.py — скрипт, который автоматически извлекает все необходимые данные и выводит их в консоль. Внутри скрипта захардкожены путь до файла CAP и BSSID.
Использование этого скрипта поможет быстро подготовить данные для дальнейшего подбора пароля.

Эти данные можно извлечь с помощью следующих инструментов:  

1. **Aircrack-ng** — позволяет отобразить информацию о хендшейке, включая необходимые параметры, с помощью команды:  
   ```bash
   aircrack-ng -J /dev/null data/capture-01.cap
   ```
2. **`test_handshake.py`** — скрипт, который извлекает все необходимые данные и выводит их в консоль. Внутри скрипта захардкожены путь до файла CAP и BSSID.

Использование этих инструментов поможет быстро подготовить данные для дальнейшего подбора пароля. 

## Генераця MIC
для генерации Message Integrity Code (MIC) который сравниваеца с оригинальным 
1. генерируеться Pairwise Master Key (PMK) из пароля и ssid который используеться в качестве salt в pbkdf2_hmac_sha1
2. генерируеться Pairwise Transport Key (PTK) из PMK и сложенных в правильном порядке bssid, sta, anonce, snonce
